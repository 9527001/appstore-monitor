<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="App Store 应用上线监控工具">
    <title>App Store 应用上线监控</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="apple-touch-icon" href="favicon.svg">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <h1>📱 App Store 应用上线监控</h1>
                <a href="help.html" target="_blank" class="help-link" title="查看使用文档">📖 使用文档</a>
            </div>
            <p class="subtitle">实时监控应用在 App Store 的上线状态</p>
        </header>

        <!-- CORS 提示 -->
        <div id="corsWarning" class="cors-warning" style="display: none;">
            <div class="cors-warning-content">
                <strong>⚠️ 重要提示：</strong>
                <p>检测到您正在通过本地文件系统访问（file://），这会导致 CORS 跨域问题。</p>
                <p><strong>请通过 HTTP 服务器运行：</strong></p>
                <div class="cors-warning-commands">
                    <code>python3 -m http.server 8000</code>
                    <span>或</span>
                    <code>npx http-server</code>
                </div>
                <p>然后访问 <code>http://localhost:8000</code></p>
                <button onclick="document.getElementById('corsWarning').style.display='none'" class="btn btn-outline">我知道了</button>
            </div>
        </div>

        <!-- 应用信息卡片 -->
        <div class="app-info-panel" id="appInfoPanel" style="display: none;">
            <div class="app-info-card" id="appInfoCard">
                <div class="app-info-content">
                    <img id="appIcon" src="" alt="应用图标" class="app-icon" onerror="this.style.display='none'">
                    <div class="app-info-details">
                        <h3 id="appName" class="app-name">-</h3>
                        <p id="appVersion" class="app-version">版本: -</p>
                    </div>
                </div>
                <a id="appStoreLink" href="#" target="_blank" class="app-store-link">
                    <span>前往 App Store</span>
                    <span>→</span>
                </a>
            </div>
        </div>

        <!-- 目标查询结果 - 突出显示 -->
        <div class="version-panel highlight-panel">
            <h2>🎯 目标版本查询结果</h2>
            <div id="versionInfo" class="version-box">
                <div class="version-main">
                    <div class="version-main-item">
                        <div class="version-main-label">目标版本</div>
                        <div id="targetVersionDisplay" class="version-main-value">-</div>
                    </div>
                    <div class="version-main-item">
                        <div class="version-main-label">上线状态</div>
                        <div id="targetVersionStatus" class="version-main-status">-</div>
                    </div>
                </div>
                <div class="version-secondary">
                    <span class="version-secondary-label">当前版本:</span>
                    <span id="currentVersion" class="version-secondary-value">-</span>
                </div>
            </div>
        </div>

        <!-- 监控状态 -->
        <div class="status-panel">
            <div id="statusInfo" class="status-info">
                <div class="status-main">
                    <span class="status-label">查询状态:</span>
                    <span id="status" class="status-value">未开始</span>
                </div>
                <div class="status-details">
                    <span class="status-detail-item">
                        <span class="status-detail-label">下次查询:</span>
                        <span id="nextCheck" class="status-detail-value">-</span>
                    </span>
                    <span class="status-detail-item">
                        <span class="status-detail-label">查询次数:</span>
                        <span id="queryCount" class="status-detail-value">0</span>
                    </span>
                </div>
            </div>
        </div>

        <!-- 主要配置 -->
        <div class="config-panel">
            <h2>主要配置</h2>
            <div class="form-row">
                <div class="form-group form-group-primary">
                    <label for="appId">应用ID (App ID)</label>
                    <input type="text" id="appId" placeholder="例如: 1514564893" value="1514564893">
                    <small>在 App Store 链接中找到，如: apps.apple.com/app/id<span style="color: #007AFF;">1514564893</span></small>
                </div>
                <div class="form-group form-group-primary">
                    <label for="targetVersion">目标版本号</label>
                    <input type="text" id="targetVersion" placeholder="例如: 4.9.1">
                    <small>输入要查询的版本号，用于检查该版本是否已上线</small>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group form-group-secondary">
                    <label for="country">国家/地区</label>
                    <select id="country">
                        <option value="cn" selected>中国 (cn)</option>
                        <option value="us">美国 (us)</option>
                        <option value="jp">日本 (jp)</option>
                        <option value="kr">韩国 (kr)</option>
                        <option value="gb">英国 (gb)</option>
                        <option value="au">澳大利亚 (au)</option>
                    </select>
                </div>
                <div class="form-group form-group-secondary">
                    <label for="frequency">请求频率 (秒)</label>
                    <input type="number" id="frequency" min="10" max="3600" value="60" step="10">
                    <small>每多少秒查询一次（最小10秒，最大3600秒）</small>
                </div>
            </div>
            <div class="form-group">
                <label for="webhookUrl">Webhook URL (可选)</label>
                <input type="url" id="webhookUrl" placeholder="https://example.com/webhook">
                <small>查询成功后发送通知的 webhook 地址（可选）</small>
            </div>
            <div class="button-group">
                <button id="startBtn" class="btn btn-primary">开始监控</button>
                <button id="stopBtn" class="btn btn-secondary" disabled>停止监控</button>
                <button id="clearBtn" class="btn btn-outline">清空记录</button>
            </div>
        </div>

        <!-- 高级配置（可折叠） -->
        <div class="config-panel advanced-config">
            <div class="advanced-header">
                <h2>高级配置</h2>
                <span class="toggle-icon">▼</span>
            </div>
            <div class="advanced-content">
                <div class="form-group">
                    <label for="startTime">开始时间</label>
                    <input type="datetime-local" id="startTime">
                    <small>设置监控开始的时间（可选，留空则立即开始）</small>
                </div>
            </div>
        </div>

        <div class="result-panel">
            <h2>查询记录</h2>
            <div id="resultList" class="result-list">
                <div class="empty-state">暂无查询记录</div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>

